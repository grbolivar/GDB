class GDB{constructor(t="default"){this.name=t;this.t="default";this.s="readonly";this.i="readwrite";this.h=new Promise((s,i)=>{const e=indexedDB.open(t,1);e.onerror=t=>i(e.error);e.onsuccess=t=>s(e.result);e.onupgradeneeded=t=>{e.result.createObjectStore(this.t)}})}get(t){let s;return this.l(this.s,i=>{s=i.get(t)}).then(t=>s.result)}set(t,s){return this.l(this.i,i=>{i.put(s,t)})}del(t){return this.l(this.i,s=>{s.delete(t)})}clear(){return this.l(this.i,t=>{t.clear()})}keys(){const t=[];return this.l(this.s,s=>{(s.openKeyCursor||s.openCursor).call(s).onsuccess=function(){let s=this.result;if(s){t.push(s.key);s.continue()}}}).then(s=>t)}all(){let t={};return this.h.then(s=>new Promise((i,e)=>{this.keys().then(r=>{let h=this.t,n=s.transaction(h,this.s),l=n.objectStore(h);n.oncomplete=s=>{Object.keys(t).forEach(s=>t[s]=t[s].result);i(t)};n.onabort=n.onerror=t=>e(n.error);r.forEach(s=>t[s]=l.get(s))})}))}size(){return this.keys().then(t=>t.length)}l(t,s){return this.h.then(i=>new Promise((e,r)=>{const h=i.transaction(this.t,t);h.oncomplete=t=>e();h.onabort=h.onerror=t=>r(h.error);s(h.objectStore(this.t))}))}}